// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.960
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func LoginPage(errorMsg string) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"container\" style=\"padding-top: var(--spacing-2xl); padding-bottom: var(--spacing-2xl); max-width: 400px;\"><div class=\"card\"><div style=\"text-align: center; margin-bottom: var(--spacing-xl);\"><h1 style=\"font-family: var(--font-serif); font-size: 1.75rem; font-weight: 600; margin-bottom: var(--spacing-sm);\">Welcome</h1><p style=\"color: var(--color-slate-light);\">Sign in to access Resume Tweaker.</p></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if errorMsg != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<div style=\"background-color: var(--color-bg-error); border-left: 3px solid var(--color-text-error); padding: var(--spacing-md); border-radius: var(--border-radius); margin-bottom: var(--spacing-lg);\"><p style=\"color: var(--color-text-error); font-size: 0.9375rem;\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var3 string
				templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(errorMsg)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `templates/login.templ`, Line: 19, Col: 17}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "</p></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<div id=\"error-message\" style=\"display: none; background-color: var(--color-bg-error); border-left: 3px solid var(--color-text-error); padding: var(--spacing-md); border-radius: var(--border-radius); margin-bottom: var(--spacing-lg);\"><p style=\"color: var(--color-text-error); font-size: 0.9375rem;\" id=\"error-text\"></p></div><button id=\"github-login\" class=\"btn-primary\" style=\"width: 100%; display: flex; align-items: center; justify-content: center; gap: var(--spacing-sm);\"><svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"></path></svg> Continue with GitHub</button><div style=\"margin-top: var(--spacing-xl); text-align: center;\"><a href=\"/\" style=\"color: var(--color-sage); text-decoration: none; font-size: 0.875rem;\">&larr; Back to home</a></div></div></div><!-- PocketBase SDK --> <script src=\"https://cdn.jsdelivr.net/npm/pocketbase@0.25.0/dist/pocketbase.umd.min.js\"></script> <script>\n\t\t\tconst pb = new PocketBase(window.location.origin);\n\n\t\t\t// Check if already logged in (but only redirect if we have a valid cookie too)\n\t\t\t// This prevents redirect loops when localStorage has stale data\n\t\t\tif (pb.authStore.isValid && document.cookie.includes('pb_auth=')) {\n\t\t\t\twindow.location.href = '/app/tweak';\n\t\t\t}\n\n\t\t\t// IMPORTANT: Do NOT use async/await in click handler - causes popup blocking issues\n\t\t\t// See: https://pocketbase.io/docs/authentication/#authenticate-with-oauth2\n\t\t\tdocument.getElementById('github-login').addEventListener('click', function() {\n\t\t\t\tconst btn = document.getElementById('github-login');\n\t\t\t\tconst errorDiv = document.getElementById('error-message');\n\t\t\t\tconst errorText = document.getElementById('error-text');\n\n\t\t\t\tbtn.disabled = true;\n\t\t\t\tbtn.innerHTML = '<span class=\"spinner\"></span> Connecting...';\n\t\t\t\terrorDiv.style.display = 'none';\n\n\t\t\t\tpb.collection('users').authWithOAuth2({\n\t\t\t\t\tprovider: 'github',\n\t\t\t\t\t// Explicitly set the callback URL to PocketBase's OAuth redirect handler\n\t\t\t\t\turlCallback: function(url) {\n\t\t\t\t\t\t// Open popup manually to avoid issues\n\t\t\t\t\t\tconst popup = window.open(\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\t'oauth2-popup',\n\t\t\t\t\t\t\t'width=600,height=700,menubar=no,toolbar=no,status=no,scrollbars=yes'\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn popup;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\t.then(function(authData) {\n\t\t\t\t\t\t// Store JWT in cookie for server-side auth\n\t\t\t\t\t\tconst isSecure = window.location.protocol === 'https:';\n\t\t\t\t\t\tconst secureFlag = isSecure ? '; Secure' : '';\n\t\t\t\t\t\tdocument.cookie = 'pb_auth=' + pb.authStore.token + '; path=/; max-age=' + (7 * 24 * 60 * 60) + '; SameSite=Lax' + secureFlag;\n\n\t\t\t\t\t\t// Small delay to ensure cookie is saved before redirect\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\twindow.location.href = '/app/tweak';\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function(err) {\n\t\t\t\t\t\tconsole.error('OAuth error:', err);\n\t\t\t\t\t\terrorText.textContent = err.message || 'Failed to sign in with GitHub';\n\t\t\t\t\t\terrorDiv.style.display = 'block';\n\n\t\t\t\t\t\tbtn.disabled = false;\n\t\t\t\t\t\tbtn.innerHTML = '<svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z\"/></svg> Continue with GitHub';\n\t\t\t\t\t});\n\t\t\t});\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = Layout("Login").Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
